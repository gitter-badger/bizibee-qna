<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:a="http://aripd.com/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:o="http://omnifaces.org/ui"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                template="/template_landing.xhtml">
    <ui:define name="head">
        <style type="text/css">
            .ui-steps .ui-steps-item {
                width: calc(100% * 2 / #{simulationView.menuModel.elements.size()});
                height: 100px;
            }
            .ui-steps .ui-steps-item .ui-menuitem-link .ui-steps-title {
                white-space: initial;
            }
        </style>
    </ui:define>
    <ui:define name="content">
        <f:metadata>
            <f:viewParam name="uuid" value="#{simulationView.uuid}"/>
            <f:event type="preRenderView" listener="#{simulationView.onLoad}"/>
        </f:metadata>

        <div id="features">
            <div class="features-content">
                <h1 class="features-title">#{i18n['Simulation']} | #{dashboardView.selectedUser.simulation.name}</h1>
                <h:panelGrid columns="2" columnClasses="ui-g-3,ui-g-9">
                    <a:identicon text="#{dashboardView.selectedUser.email}" style="width: 100%;" rendered="#{empty dashboardView.selectedUser.bytes}"/>
                    <o:graphicImage value="#{dashboardView.selectedUser.bytes}" dataURI="true" style="width: 100%;" alt="#{dashboardView.selectedUser.name}" title="#{dashboardView.selectedUser.name}" rendered="#{not empty dashboardView.selectedUser.bytes}"/>
                    <h2>#{dashboardView.selectedUser.name}</h2>
                </h:panelGrid>

                <div class="ui-g ui-fluid dashboard">
                    <div class="ui-g-12 ui-md-12">
                        <p:steps activeIndex="#{simulationView.sequence}" readonly="true" model="#{simulationView.menuModel}"/>
                    </div>
                    <div class="ui-g-8">
                        <h3><h:outputText value="#{simulationView.selectedRecord.description}"/></h3>
                        <o:graphicImage value="#{simulationView.selectedRecord.bytes}" dataURI="true" width="100%" rendered="#{not empty simulationView.selectedRecord.bytes}"/>

                        <h:form rendered="#{simulationView.selectedRecord.decisionType eq 'SINGLE_CHOICE'}">
                            <p:selectOneRadio value="#{simulationView.model1.decisionchoice}" 
                                              label="#{simulationView.selectedRecord.name}" 
                                              required="#{simulationView.selectedRecord.required}" 
                                              disabled="#{simulationView.disabled}"
                                              layout="pageDirection" columns="1"
                                              converter="#{decisionchoiceConverter}">
                                <f:selectItems value="#{simulationView.selectedRecord.decisionchoices}" var="decisionchoice" itemValue="#{decisionchoice}" itemLabel="#{decisionchoice.name}"/>
                            </p:selectOneRadio>
                            <p:commandButton value="#{i18n['Submit']}" disabled="#{simulationView.disabled}" update="@form, :growl" actionListener="#{simulationView.doUpdate}"/>
                        </h:form>

                        <h:form rendered="#{simulationView.selectedRecord.decisionType eq 'MULTIPLE_CHOICE'}">
                            <p:selectManyCheckbox value="#{simulationView.model2.decisionchoices}" 
                                                  label="#{simulationView.selectedRecord.name}" 
                                                  required="#{simulationView.selectedRecord.required}" 
                                                  disabled="#{simulationView.disabled}"
                                                  layout="pageDirection" columns="1"
                                                  converter="#{decisionchoiceConverter}">
                                <f:selectItems value="#{simulationView.selectedRecord.decisionchoices}" var="decisionchoice" itemValue="#{decisionchoice}" itemLabel="#{decisionchoice.name}"/>
                            </p:selectManyCheckbox>
                            <p:commandButton value="#{i18n['Submit']}" disabled="#{simulationView.disabled}" update="@form, :growl" actionListener="#{simulationView.doUpdate}"/>
                        </h:form>

                        <h:form rendered="#{simulationView.selectedRecord.decisionType eq 'SINGLE_SKU_LISTING'}">
                            <p:selectOneRadio value="#{simulationView.model3.sku}" 
                                              label="#{simulationView.selectedRecord.name}" 
                                              required="#{simulationView.selectedRecord.required}" 
                                              disabled="#{simulationView.disabled}"
                                              layout="pageDirection" columns="1"
                                              converter="#{skuConverter}">
                                <f:selectItems value="#{simulationView.selectedRecord.skus}" var="sku" itemValue="#{sku}" itemLabel="#{sku.brand.name} #{sku.name}"/>
                            </p:selectOneRadio>
                            <p:commandButton value="#{i18n['Submit']}" disabled="#{simulationView.disabled}" update="@form, :growl" actionListener="#{simulationView.doUpdate}"/>
                        </h:form>

                        <h:form rendered="#{simulationView.selectedRecord.decisionType eq 'MULTIPLE_SKU_LISTING'}">
                            <p:selectManyCheckbox value="#{simulationView.model4.skus}" 
                                                  label="#{simulationView.selectedRecord.name}" 
                                                  required="#{simulationView.selectedRecord.required}" 
                                                  disabled="#{simulationView.disabled}"
                                                  layout="pageDirection" columns="1"
                                                  converter="#{skuConverter}">
                                <f:selectItems value="#{simulationView.selectedRecord.skus}" var="sku" itemValue="#{sku}" itemLabel="#{sku.brand.name} #{sku.name}"/>
                            </p:selectManyCheckbox>
                            <p:commandButton value="#{i18n['Submit']}" disabled="#{simulationView.disabled}" update="@form, :growl" actionListener="#{simulationView.doUpdate}"/>
                        </h:form>

                        <h:form rendered="#{simulationView.selectedRecord.decisionType eq 'RANGE_SKU_LISTING'}">
                            <p:repeat var="model" value="#{simulationView.model5}">
                                <h:outputText value="#{model.sku.brand.name} #{model.sku.name}"/>
                                <h:panelGrid columns="2">
                                    <p:spinner value="#{model.value}" 
                                               label="#{simulationView.selectedRecord.name}" 
                                               required="#{simulationView.selectedRecord.required}" 
                                               disabled="#{simulationView.disabled}"
                                               min="#{model.sku.indexMin}" 
                                               max="#{model.sku.indexMax}" 
                                               stepFactor="#{model.sku.indexStep}"/>
                                    <h:outputFormat value="{0} ürünü için {1} index ile {2} index arasinda bir fiyat belirleyin">
                                        <f:param value="#{model.sku.name}"/>
                                        <f:param value="#{model.sku.indexMin}"/>
                                        <f:param value="#{model.sku.indexMax}"/>
                                    </h:outputFormat>
                                </h:panelGrid>
                            </p:repeat>
                            <p:commandButton value="#{i18n['Submit']}" disabled="#{simulationView.disabled}" update="@form, :growl" actionListener="#{simulationView.doUpdate}"/>
                        </h:form>

                        <h:form rendered="#{simulationView.selectedRecord.decisionType eq 'SINGLE_CHOICE_SKU_LISTING'}">
                            <p:repeat var="model" value="#{simulationView.model6}">
                                <h:outputText value="#{model.sku.brand.name} #{model.sku.name}"/>
                                <p:selectOneRadio value="#{model.decisionchoice}" 
                                                  label="#{simulationView.selectedRecord.name}" 
                                                  required="#{simulationView.selectedRecord.required}" 
                                                  disabled="#{simulationView.disabled}"
                                                  converter="#{decisionchoiceConverter}">
                                    <f:selectItems value="#{simulationView.selectedRecord.decisionchoices}" var="decisionchoice" itemValue="#{decisionchoice}" itemLabel="#{decisionchoice.name}"/>
                                </p:selectOneRadio>
                            </p:repeat>
                            <p:commandButton value="#{i18n['Submit']}" disabled="#{simulationView.disabled}" update="@form, :growl" actionListener="#{simulationView.doUpdate}"/>
                        </h:form>

                        <h:form rendered="#{simulationView.selectedRecord.decisionType eq 'MULTIPLE_CHOICE_SKU_LISTING'}">
                            <p:repeat var="model" value="#{simulationView.model7}">
                                <h:outputText value="#{model.sku.brand.name} #{model.sku.name}"/>
                                <p:selectManyCheckbox value="#{model.decisionchoices}" 
                                                      label="#{simulationView.selectedRecord.name}" 
                                                      required="#{simulationView.selectedRecord.required}" 
                                                      disabled="#{simulationView.disabled}"
                                                      converter="#{decisionchoiceConverter}">
                                    <f:selectItems value="#{simulationView.selectedRecord.decisionchoices}" var="decisionchoice" itemValue="#{decisionchoice}" itemLabel="#{decisionchoice.name}"/>
                                </p:selectManyCheckbox>
                            </p:repeat>
                            <p:commandButton value="#{i18n['Submit']}" disabled="#{simulationView.disabled}" update="@form, :growl" actionListener="#{simulationView.doUpdate}"/>
                        </h:form>
                    </div>
                    <div class="ui-g-4">
                        <h:form id="panel">
                            <p:panel>
                                <h:panelGroup rendered="#{empty reportView.getResponses(dashboardView.selectedUser)}">
                                    <ul class="scores">
                                        <li>
                                            <span class="count revenue">
                                                <h:outputText value="#{reportView.simulation.salesStart}">
                                                    <f:convertNumber type="number" />
                                                </h:outputText>
                                            </span>
                                            <h:outputText id="revenue" value="#{i18n['Revenue']}" styleClass="title" />
                                            <p:tooltip for="revenue" position="top" style="width: 300px;" value="Turnover comprises sales of goods and services after deduction of discounts and sales taxes. It does not include sales between group companies. Discounts include rebates, price reductions and incentives given to customers, promotional couponing and trade communication costs. Turnover is recognised when the risks and rewards of the underlying products and services have been substantially transferred to the customer. Revenue from services is recognised as the services are performed. Interest revenue is recognised as interest accrues using the effective interest method." />
                                            <span class="detail"></span>
                                        </li>
                                        <li>
                                            <span class="count budget">
                                                <h:outputText value="#{reportView.simulation.budgetStart}">
                                                    <f:convertNumber type="number" />
                                                </h:outputText>
                                            </span>
                                            <h:outputText id="budget" value="#{i18n['Budget']}" styleClass="title" />
                                            <p:tooltip for="budget" position="top" style="width: 300px;" value="Budget is a quantitative expression of a plan for a defined period of time. It may include planned sales volumes and revenues, resource quantities, costs and expenses, assets, liabilities and cash flows." />
                                            <span class="detail">Restriction on expenditure</span>
                                        </li>
                                        <li>
                                            <span class="count grossmargin">
                                                <h:outputText value="#{reportView.simulation.gmStart}">
                                                    <f:convertNumber type="percent" />
                                                </h:outputText>
                                            </span>
                                            <h:outputText id="grossmargin" value="#{i18n['Gross Margin']}" styleClass="title" />
                                            <p:tooltip for="grossmargin" position="top" style="width: 300px;" value="Gross Margin represents the percent of total sales revenue that the company retains after incurring the direct costs associated with producing the goods and services it sells. The higher the percentage, the more the company retains on each dollar of sales, to service its other costs and debt obligations." />
                                            <span class="detail">Revenue minus cost of goods sold</span>
                                        </li>
                                        <li>
                                            <span class="count marketshare">
                                                <h:outputText value="#{reportView.simulation.msStart}">
                                                    <f:convertNumber type="percent" />
                                                </h:outputText>
                                            </span>
                                            <h:outputText id="marketshare" value="#{i18n['Market Share']}" styleClass="title" />
                                            <p:tooltip for="marketshare" position="top" style="width: 300px;" value="Market Share represents the percentage of an industry or market's total sales that is earned by a particular company over a specified time period. Market share is calculated by taking the company's sales over the period and dividing it by the total sales of the industry over the same period. This metric is used to give a general idea of the size of a company in relation to its market and its competitors." />
                                            <span class="detail">Portion of the market</span>
                                        </li>
                                    </ul>
                                </h:panelGroup>

                                <ui:repeat var="response" value="#{reportView.getResponses(dashboardView.selectedUser)}" varStatus="varStatus" rendered="#{not empty reportView.getResponses(dashboardView.selectedUser)}">
                                    <h:panelGroup style="#{varStatus.last?'display: block;':'display: none;'}">
                                        <h:outputText value="#{reportView.calculateScore(response)}" style="display:none;" />

                                        <ul class="scores">
                                            <li>
                                                <span class="count revenue">
                                                    <h:outputText value="#{reportView.sales}">
                                                        <f:convertNumber type="number" maxFractionDigits="0" />
                                                    </h:outputText>
                                                </span>
                                                <h:outputText id="revenue" value="#{i18n['Revenue']}" styleClass="title" />
                                                <p:tooltip for="revenue" position="top" style="width: 300px;" value="Turnover comprises sales of goods and services after deduction of discounts and sales taxes. It does not include sales between group companies. Discounts include rebates, price reductions and incentives given to customers, promotional couponing and trade communication costs. Turnover is recognised when the risks and rewards of the underlying products and services have been substantially transferred to the customer. Revenue from services is recognised as the services are performed. Interest revenue is recognised as interest accrues using the effective interest method." />
                                                <span class="detail">
                                                    <h:outputText value="#{reportView.usgChange}">
                                                        <f:convertNumber type="percent" />
                                                    </h:outputText>
                                                </span>
                                            </li>
                                            <li>
                                                <span class="count budget">
                                                    <h:outputText value="#{reportView.budget}">
                                                        <f:convertNumber type="number" />
                                                    </h:outputText>
                                                </span>
                                                <h:outputText id="budget" value="#{i18n['Budget']}" styleClass="title" />
                                                <p:tooltip for="budget" position="top" style="width: 300px;" value="Budget is a quantitative expression of a plan for a defined period of time. It may include planned sales volumes and revenues, resource quantities, costs and expenses, assets, liabilities and cash flows." />
                                                <span class="detail">
                                                    <h:outputText value="#{reportView.budgetChange}">
                                                        <f:convertNumber type="number" />
                                                    </h:outputText>
                                                </span>
                                            </li>
                                            <li>
                                                <span class="count grossmargin">
                                                    <h:outputText value="#{reportView.gm}">
                                                        <f:convertNumber type="percent" />
                                                    </h:outputText>
                                                </span>
                                                <h:outputText id="grossmargin" value="#{i18n['Gross Margin']}" styleClass="title" />
                                                <p:tooltip for="grossmargin" position="top" style="width: 300px;" value="Gross Margin represents the percent of total sales revenue that the company retains after incurring the direct costs associated with producing the goods and services it sells. The higher the percentage, the more the company retains on each dollar of sales, to service its other costs and debt obligations." />
                                                <span class="detail">
                                                    <h:outputText value="#{reportView.gmChange}">
                                                        <f:convertNumber type="percent" />
                                                    </h:outputText>
                                                </span>
                                            </li>
                                            <li>
                                                <span class="count marketshare">
                                                    <h:outputText value="#{reportView.ms}">
                                                        <f:convertNumber type="percent" />
                                                    </h:outputText>
                                                </span>
                                                <h:outputText id="marketshare" value="#{i18n['Market Share']}" styleClass="title" />
                                                <p:tooltip for="marketshare" position="top" style="width: 300px;" value="Market Share represents the percentage of an industry or market's total sales that is earned by a particular company over a specified time period. Market share is calculated by taking the company's sales over the period and dividing it by the total sales of the industry over the same period. This metric is used to give a general idea of the size of a company in relation to its market and its competitors." />
                                                <span class="detail">
                                                    <h:outputText value="#{reportView.msChange}">
                                                        <f:convertNumber type="percent" />
                                                    </h:outputText>
                                                </span>
                                            </li>
                                        </ul>
                                    </h:panelGroup>
                                </ui:repeat>
                                <f:facet name="footer">
                                    <p:commandButton value="#{i18n['Next']}" action="#{simulationView.goNext}" disabled="#{!simulationView.disabled}" />
                                    <div style="text-align: right;">
                                        <h:outputFormat value="{0} of {1}" style="font-style: italic;">
                                            <f:param value="#{simulationView.sequence+1}" />
                                            <f:param value="#{simulationView.menuModel.elements.size()}" />
                                        </h:outputFormat>
                                    </div>
                                </f:facet>
                            </p:panel>
                        </h:form>
                        <p:sticky target="panel" margin="90" />
                    </div>
                </div>
            </div>

        </div>
    </ui:define>
</ui:composition>